[qdata,qhat,qaverage] = ImportDemandData('demand_data.csv', 1, 24);

fig1=1;
FontSize = 16;

% Plot qdata vs qhat
% Plot qhat vs qaverage
figure(fig1)
subplot(2,1,1)
plot(qdata,qhat,'.')
xlabel('Actual consumption','FontSize',FontSize);
ylabel('Predicted demand','FontSize',FontSize);

subplot(2,1,2)
plot(qhat,qaverage,'.')
xlabel('Actual prices','FontSize',FontSize);
ylabel('Average prices','FontSize',FontSize);
print(fig1,'fig0_model_fit.eps','-depsc');


% for each product, plot demand
J = 24;
K = 5;
np = 30;
price = zeros(np,J);
quantity = zeros(np,K+1,J);
qtemp    = zeros(np,K+1);
FruitLabels = {'Apricots'; ...
               'Avocados'; ...
               'Bananas'; ...
               'Berries'; ...
               'Cherries'; ...
               'Dates'; ...
               'Apples'; ...
               'Easy Peelers'; ...
               'Grapes'; ...
               'Grapefruits'; ...
               'Kiwis'; ...
               'Lemons and limes'; ...
               'Lychees'; ...
               'Mangos'; ...
               'Melons'; ...
               'Oranges'; ...
               'Passion fruits'; ...
               'Paw-paws'; ...
               'Pears'; ...
               'Pineapples'; ...
               'Peaches, plums, and nectarines'; ...
               'Pomegranates'; ...
               'Rhubarb'; ...
               'Sharon fruits'};
for j1=1:J
  if (j1<10)
    str1 = ['demand0',int2str(j1),'.csv'];
  else
    str1 = ['demand',int2str(j1),'.csv'];
  end
  str2 = sprintf('%c%c%c%c',FruitLabels{j1});
  [price(:,j1),      ...
   quantity(:,1,j1), ...
   quantity(:,2,j1), ...
   quantity(:,3,j1), ...
   quantity(:,4,j1), ...
   quantity(:,5,j1), ...
   quantity(:,6,j1)] = ImportDemandData2(str1, 1, np);
   fig1=fig1+1;
   figure(fig1)
   
   NewPlotFlag=1;
   if NewPlotFlag==0   
     subplot(2,1,1)
     plot(price(:,j1),quantity(:,1,j1))
     title(['Demand for ',FruitLabels{j1}],'FontSize',FontSize);
     xlabel('price','FontSize',FontSize)
     ylabel('quantity','FontSize',FontSize)
     subplot(2,1,2)
     plot(price(:,j1),reshape(quantity(:,2:K+1,j1),[np K]));
     legend('One item','Two items','Three items','Four items','Five items')
     print(fig1,['fig',int2str(j1),'_',str2,'.eps'],'-depsc');
   elseif NewPlotFlag==1
     area(price(:,j1),quantity(:,2:K+1,j1))
     title(['Demand for ',FruitLabels{j1}],'FontSize',FontSize);
     xlabel('price','FontSize',FontSize)
     ylabel('quantity','FontSize',FontSize)
     legend('One item','Two items','Three items','Four items','Five items')
     print(fig1,['fig',int2str(j1),'_',str2,'.eps'],'-depsc');
   end
end

% Load elasticities
elas = ImportElasticity('elas.csv', 1, J);
CreateElasTable('elas1.tex',elas,FruitLabels);
